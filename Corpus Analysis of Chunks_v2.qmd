---
title: "Corpus Analysis of Chunks"
author: "Longjiao and Wanyin"
self-contained: true
format: html
editor: visual
execute: 
  echo: false
  message: false
  warning: false
---

# Pre-processing Codes

#### The following code applies to all models:

```{r}
#|label: source pre-processing codes and read MWS data

GECOs <- read.delim('Data_MWS.txt', header = TRUE, sep = "\t", encoding = "UTF-8", quote = "", na.strings=".")

LEXTALE <- read.delim('LEXTALE.txt', header = TRUE, sep = "\t", encoding = "UTF-8", quote = "", na.strings=".")

source("pre-processing_v2.R")
library(lme4)
library(lmerTest)
library(effects)
library(car)
library(here)
```

# MWS

## Total Reading Times

### First, we start with maximal model, then reduce random effects; the entire chucnk below (not shown in html) for findings random strucutre

The `echo: false` option disables the printing of code (only output is displayed).

```{r}
#| label: Random_MWS_total_D
#| eval: false
#| include: false
# Full model
fm1 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
               #   MWS_Frequency_scale_center + 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm8)



#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_DWELL_TIME_100_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm10)
anova(fm8, fm10, refit=FALSE)






#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_DWELL_TIME_100_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                #   Noun_Word_Frequency_scale_center+
                #   MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm11, refit=FALSE)





#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_DWELL_TIME_100_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm12, refit=FALSE)





fm13 <- lmer(IA_DWELL_TIME_100_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm13, refit=FALSE)


summary(fm13)

#====================================================================================================#
#                                          fm10 is the best                                          #
#====================================================================================================#
```

### Second, after having "best" random effects, now we move to fixed effects

(not shown in html)

```{r}
#| label: fixed_MWS_total_D
#| eval: false
#| include: false

#fm10 is same with fm14 except "REML = FALSE" in fm14
fm14_totol_D <- lmer(IA_DWELL_TIME_100_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Noun_Word_Frequency_scale_center+MWS_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , 
             data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary (fm14_totol_D)


fm15_totol_D  <- lmer(IA_DWELL_TIME_100_LOG ~ 
               MWS_Length_CENTER+
    #           MWS_Repetition_Across_Sessions_CENTER+
               Adj_Word_Repetition_Across_Sessions_CENTER+
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+ 
 #             GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#       GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Noun_Word_Frequency_scale_center+MWS_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , 
             data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm15_totol_D)
anova(fm14_totol_D, fm15_totol_D, refit=TRUE)
```

### Here we find the best-fitting final model

```{r}
#| label: fm_final_total_D


fm_final_totol_D <- lmer(IA_DWELL_TIME_100_LOG ~ 
                   MWS_Length_CENTER+
                   Adj_Word_Repetition_Across_Sessions_CENTER+
                   Noun_Word_Repetition_Across_Sessions_CENTER+
                   GROUP_sum+
                   Adj_Word_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center+ 
                   GROUP_sum:MWS_Frequency_scale_center+
                   #GROUP_sum:Noun_Word_Frequency_scale_center
                   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                  #GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
              (Noun_Word_Frequency_scale_center+MWS_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , 
                 data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm_final_totol_D)

```

### Here we plot the interaction between Adj_Word_Frequency, MWS_Frequency and group.

Higher Adjective Word Frequency facilitates reading at low MWS Frequency, but this effect diminishes and reverses at high MWS Frequency, particularly in bilinguals. In bilinguals, frequent adjectives speed reading when MWS Frequency is low but slow it down when MWS Frequency is high. Monolinguals show a similar but weaker pattern, with flatter slopes and less pronounced reversal

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center>-MWS-total


effectXY_totol_D <-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_totol_D))

effectXY_totol_D$pred_ms <- effectXY_totol_D$fit 
effectXY_totol_D$se_ms <- effectXY_totol_D$se

ggplot(effectXY_totol_D, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~ GROUP_sum )


ggplot(effectXY_totol_D, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color =  MWS_Frequency_scale_center))+
  geom_smooth(aes( group= MWS_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~ GROUP_sum )

```

### Here we plot the interaction between Noun_Word_Frequency and MWS_Frequency.

Higher Noun word frequency speeds up reading when MWS Frequency is low but this effect weakens and reverse as MWS frequency increases. For very frequent MWS, frequent nouns are associated with lower reading time.

```{r}
#| label: plot <Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center>-MWS_total_D


effectXY_totol_D <-as.data.frame(effect("Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_totol_D))
effectXY_totol_D$pred_ms <- effectXY_totol_D$fit 
effectXY_totol_D$se_ms <- effectXY_totol_D$se

ggplot(effectXY_totol_D, aes(y = pred_ms, x= Noun_Word_Frequency_scale_center, color = MWS_Frequency_scale_center))+
  geom_smooth(aes( group= MWS_Frequency_scale_center), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

## First Fixation Duration

### As above, first, we start with maximal model, then reduce random effects; the entire chucnk below (not shown in html) for findings random strucutre

```{r}
#| label: Random-First Fixation Duration
#| eval: false
#| include: false

# Full model
fm1 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
              #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
               #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
              #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
               #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                MWS_Frequency_scale_center #+ 
             #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
             #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
             |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
                 #   MWS_Frequency_scale_center + 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm8)




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center #+ 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                  #   Noun_Word_Frequency_scale_center+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm11)
anova(fm8, fm11, refit=FALSE)



#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center#+
                   #   MWS_Frequency_scale_center + 
                   #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                   #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                   |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm12)
anova(fm8, fm12, refit=FALSE)
anova(fm11, fm12, refit=FALSE)



fm13 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm13, refit=FALSE)
anova(fm11, fm13, refit=FALSE)

#====================================================================================================#
#                                          fm11 is the best                                          #
#====================================================================================================#
```

### Now, after having "best" random effects, now we move to fixed effects

(not shown in html)

```{r}
#| label: fixed-First Fixation Duration
#| eval: false
#| include: false

#fm11 is same with fm14 except "REML = FALSE" in fm14
fm14 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
               MWS_Length_CENTER +
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )
summary(fm14)
drop1(fm14)


fm15 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
           #  MWS_Repetition_Across_Sessions_CENTER+
              #Adj_Word_Repetition_Across_Sessions_CENTER+
          #   Noun_Word_Repetition_Across_Sessions_CENTER+
             GROUP_sum+
             Adj_Word_Frequency_scale_center+
             Noun_Word_Frequency_scale_center+
             MWS_Frequency_scale_center+
             GROUP_sum:Adj_Word_Frequency_scale_center+
             GROUP_sum:Noun_Word_Frequency_scale_center+
             #GROUP_sum:MWS_Frequency_scale_center+
             #Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
             Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
             #GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
            # GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
             (Adj_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000)))
drop1(fm15)
summary(fm15)

anova(fm14, fm15, refit=TRUE)


```

### Here we find the best-fitting final model First Fixation Duration (FFD)

```{r}
#| label: fm_final-First Fixation Duration (FFD)
#| 
fm_final_FFD <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
                   MWS_Length_CENTER+
                   Adj_Word_Repetition_Across_Sessions_CENTER+
                   GROUP_sum+
                   Adj_Word_Frequency_scale_center +
                   Noun_Word_Frequency_scale_center +
                   MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center +
                  #Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center +
                   #GROUP_sum:Noun_Word_Frequency_scale_center
                   (Adj_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ))


summary(fm_final_FFD)
```

### Here we report the interaction between group and Adjective word frequency in First Fixation Duration (FFD)

The facilitative effect of Adjective word frequency is strong in Bilinguals

```{r}
#| label: plot GROUP_sum:Adj_Word_Frequency_scale_center from fm_final_FFD 

effectXY_final_FFD <-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center", fm_final_FFD))
effectXY_final_FFD$pred_ms <- effectXY_final_FFD$fit 
effectXY_final_FFD$se_ms <- effectXY_final_FFD$se

ggplot(effectXY_final_FFD, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = GROUP_sum))+
  geom_smooth(aes( group= GROUP_sum), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))

```

## First Run Dwell Time

```{r}
#| label: Random- First Run 
#| eval: false
#| include: false

# Full model
fm1 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
               #   MWS_Frequency_scale_center + 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm10, refit=FALSE)




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                #   Noun_Word_Frequency_scale_center+
                #   MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm11, refit=FALSE)
anova(fm10, fm11, refit=FALSE)






#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm12, refit=FALSE)
anova(fm10, fm12, refit=FALSE)
anova(fm11, fm12, refit=FALSE)




fm13 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm13, refit=FALSE)
anova(fm10, fm13, refit=FALSE)
anova(fm11, fm13, refit=FALSE)
anova(fm12, fm13, refit=FALSE)

#====================================================================================================#
#                                          fm11 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed-First Run 
#| eval: false
#| include: false

#fm11 is same with fm14 except "REML = FALSE" in fm14
fm14 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, 
             control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )
summary(fm14)


fm15 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER+
      #         Adj_Word_Repetition_Across_Sessions_CENTER+
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
               #GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#             GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Adj_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, 
             control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


anova(fm14, fm15, refit=TRUE)
```

### We report final model of First Run Dwell Time

```{r}
#| label: fm_final-First Run 

fm_final_first_run  <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
                   MWS_Length_CENTER+
                   MWS_Repetition_Across_Sessions_CENTER+
                   Noun_Word_Repetition_Across_Sessions_CENTER+
                   GROUP_sum+
                   Adj_Word_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center+
                   GROUP_sum:MWS_Frequency_scale_center+
                   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   (Adj_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, 
                 control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm_final_first_run)
```

### plot the interaction between Noun_Word_Frequency and MWS_Frequency from First Run Dwell Time model

The facilitative effect of Noun Word Frequency diminishes and reverses as MWS Frequency increases

```{r}
#| label: plot <Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center>first_run

effectXY_first_run<-as.data.frame(effect("Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_first_run))
effectXY_first_run$pred_ms <- effectXY_first_run$fit 
effectXY_first_run$se_ms <- effectXY_first_run$se

ggplot(effectXY_first_run, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Noun_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Noun_Word_Frequency_scale_center ), method="lm",linewidth=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))

ggplot(effectXY_first_run, aes(y = pred_ms, x= Noun_Word_Frequency_scale_center, color =  MWS_Frequency_scale_center ))+
  geom_smooth(aes( group=  MWS_Frequency_scale_center ), method="lm",linewidth=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

### plot the interaction between Adj_Word_Frequency, MWS_Frequency and group from First Run Dwell Time model

This interaction is very similar to what we found in total reading time

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center>-First-Run

effectXY_first_run <-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_first_run))
effectXY_first_run$pred_ms <- effectXY_first_run$fit 
effectXY_first_run$se_ms <- effectXY_first_run$se

ggplot(effectXY_first_run, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~ GROUP_sum)


ggplot(effectXY_first_run, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~ GROUP_sum)
```

## Regression Path Duration

```{r}
#| label: Random-Regression Path Duration
#| eval: false
#| include: false

# Full model
fm1 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
               #   MWS_Frequency_scale_center + 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm10)




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                #   Noun_Word_Frequency_scale_center+
                #   MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm10, fm11, refit=FALSE)
summary(fm11)




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm10, fm12, refit=FALSE)
anova(fm11, fm12, refit=FALSE)
summary(fm12)



fm13 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm10, fm13, refit=FALSE)
anova(fm11, fm13, refit=FALSE)
anova(fm12, fm13, refit=FALSE)

#====================================================================================================#
#                                          fm12 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed-Regression Path Duration
#| eval: false
#| include: false

#fm12 is same with fm14 except "REML = FALSE" in fm14
fm14 <-  lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary (fm14)


fm15 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
        #       MWS_Repetition_Across_Sessions_CENTER+
               Adj_Word_Repetition_Across_Sessions_CENTER+
     #          Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
 #              GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
  #             Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


anova(fm14, fm15, refit=TRUE)
```

### Final model for Regression Path Duration (RPD) reported below

```{r}
#| label: fm_final- Regression Path Duration

fm_final_RPD <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
                   MWS_Length_CENTER+
                   Adj_Word_Repetition_Across_Sessions_CENTER+
                   GROUP_sum+
                   Adj_Word_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center+
                   GROUP_sum:MWS_Frequency_scale_center+
                   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


summary(fm_final_RPD)
```

### There is an 3-way interaction between Group, Adj_word_frequency and MWS frequency

Similar pattern again to total reading time and first-run reading time

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center> for Regression Path 

effectXYl_RPD <-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_RPD))
effectXYl_RPD $pred_ms <- effectXYl_RPD $fit 
effectXYl_RPD $se_ms <- effectXYl_RPD$se

ggplot(effectXYl_RPD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )


ggplot(effectXYl_RPD, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )
```

### There is an interaction between Group and MWS frequency

<just check>

```{r}
#| label: plot GROUP_sum:MWS_Frequency_scale_center from Regression Path

effectXY_final_RPD <-as.data.frame(effect("GROUP_sum:MWS_Frequency_scale_center", fm_final_RPD))
effectXY_final_RPD$pred_ms <- effectXY_final_RPD$fit 
effectXY_final_RPD$se_ms <- effectXY_final_RPD$se

ggplot(effectXY_final_RPD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = GROUP_sum))+
  geom_smooth(aes( group= GROUP_sum), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

### There is an interaction between Group and Adj_Word_Frequency

\<just check, not really meaningful\>

```{r}
#| label: plot GROUP_sum:Adj_Word_Frequency_scale_center from Regression Path

effectXY_final_RPD <-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center", fm_final_RPD))
effectXY_final_RPD$pred_ms <- effectXY_final_RPD$fit 
effectXY_final_RPD$se_ms <- effectXY_final_RPD$se

ggplot(effectXY_final_RPD, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = GROUP_sum))+
  geom_smooth(aes( group= GROUP_sum), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

## Selective Regression Path Duration

```{r}
#| label: Random-Selective Regression Path Duration
#| eval: false
#| include: false

# Full model
fm1 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
               #   MWS_Frequency_scale_center + 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm6, fm10, refit=FALSE)





#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                #   Noun_Word_Frequency_scale_center+
                #   MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm6, fm11, refit=FALSE)
anova(fm10, fm11, refit=FALSE)
summary(fm11)





#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm6, fm12, refit=FALSE)
anova(fm11, fm12, refit=FALSE)



fm13 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm6, fm13, refit=FALSE)

#====================================================================================================#
#                                          fm11 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed
#| eval: false
#| include: false

#fm11 is same with fm14 except "REML = FALSE" in fm14
fm14 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center |PP_ID) + (1|IA_LABEL) , 
             data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm14)


fm15 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
    #           MWS_Repetition_Across_Sessions_CENTER+
               Adj_Word_Repetition_Across_Sessions_CENTER+
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
  #             GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Adj_Word_Frequency_scale_center |PP_ID) + (1|IA_LABEL) , 
             data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


anova(fm14, fm15, refit=TRUE)
```

```{r}
#| label: fm_final-Selective Regression Path Duration

fm_final_SRPD <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
                   MWS_Length_CENTER+
                   Adj_Word_Repetition_Across_Sessions_CENTER+
                   Noun_Word_Repetition_Across_Sessions_CENTER+
                   GROUP_sum+
                   Adj_Word_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center+
                   GROUP_sum:MWS_Frequency_scale_center+
                   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   (Adj_Word_Frequency_scale_center |PP_ID) + (1|IA_LABEL) , 
                 data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm_final_SRPD)

```

### There is an interaction between Noun_Word_Frequency and MWS_Frequency

```{r}
#| label: plot <Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center>Selective Regression Path Duration

effectXY_SRPD<-as.data.frame(effect("Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_SRPD))
effectXY_SRPD$pred_ms <- effectXY_SRPD$fit 
effectXY_SRPD$se_ms <- effectXY_SRPD$se

ggplot(effectXY_SRPD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Noun_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Noun_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))

ggplot(effectXY_SRPD, aes(y = pred_ms, x= Noun_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center  ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

### Another 3-way interaction: Group, Adj_Word_Frequency, MWS_Frequency

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center>-SRPD

effectXY_SRPD<-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_SRPD))
effectXY_SRPD$pred_ms <- effectXY_SRPD$fit 
effectXY_SRPD$se_ms <- effectXY_SRPD$se

ggplot(effectXY_SRPD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )


ggplot(effectXY_SRPD, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center))+
  geom_smooth(aes( group= MWS_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )
```

## Skip

```{r}
#| label: Random-Skip
#| eval: false
#| include: false

# Full model
fm1 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, 
             family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

summary(fm1)



#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
                #  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, 
             family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm2)




#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, 
             family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm3)
anova(fm2, fm3)




#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
              #    MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, 
             family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm4)




#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                #  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, 
             family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm5)



#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, 
             family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm6)



#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                MWS_Frequency_scale_center #+ 
             #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
             #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
             |PP_ID) + (1|IA_LABEL) , data = Data_all, 
             family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm7)



#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                #  MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, 
             family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm8)



#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  #Noun_Word_Frequency_scale_center+
                    MWS_Frequency_scale_center #+ 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, 
             family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm9)



#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (# Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center #+ 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, 
              family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm10)




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( Adj_Word_Frequency_scale_center#+
                  # Noun_Word_Frequency_scale_center+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, 
              family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm11)




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#

fm12 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( #Adj_Word_Frequency_scale_center+
                    Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, 
              family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm12)



fm13 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (1|PP_ID) + (1|IA_LABEL) , data = Data_all, 
              family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm13)

#====================================================================================================#
#                                          fm13 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed-Skip
#| eval: false
#| include: false

fm13 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (1|PP_ID) + (1|IA_LABEL) , data = Data_all, 
              family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

summary(fm13)

fm15 <- glmer(IA_SKIP ~ 
               MWS_Length_CENTER+
         #      MWS_Repetition_Across_Sessions_CENTER+
               Adj_Word_Repetition_Across_Sessions_CENTER+
          #     Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
   #            GROUP_sum:Adj_Word_Frequency_scale_center+
  #             GROUP_sum:Noun_Word_Frequency_scale_center+
    #           GROUP_sum:MWS_Frequency_scale_center+
                Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
     #          Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
 #              GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                (1|PP_ID) + (1|IA_LABEL) , data = Data_all, 
              family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F))

summary(fm15)
anova(fm13, fm15)
```

### Here, the summary of the final model for skipping

```{r}
#| label: fm_final_skip

fm_final_Skip<- glmer(IA_SKIP ~ 
                   MWS_Length_CENTER+
                   Adj_Word_Repetition_Across_Sessions_CENTER+
                   GROUP_sum+
                   Adj_Word_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center+
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center +
                   (1|PP_ID) + (1|IA_LABEL) , data = Data_all, 
                 family=binomial, control = glmerControl(optimizer = "nloptwrap", calc.derivs = F))

summary(fm_final_Skip)
```

### There is an interaction between Adj word frequency and MWS frequency

```{r}
#| label: plot <Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center> for skipping

effectXY_Skip<-as.data.frame(effect("Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_Skip))
effectXY_Skip$pred_ms <- effectXY_Skip$fit 
effectXY_Skip$se_ms <- effectXY_Skip$se

ggplot(effectXY_Skip, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))

ggplot(effectXY_SRPD, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center  ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

## Fixation Count

```{r}
#| label: Random-Count
#| eval: false
#| include: false

# Full model
fm1 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
                #  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 





#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
              #    MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                #  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                MWS_Frequency_scale_center #+ 
             #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
             #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
             |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                #  MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  #Noun_Word_Frequency_scale_center+
                    MWS_Frequency_scale_center #+ 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (# Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center #+ 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( Adj_Word_Frequency_scale_center#+
                  # Noun_Word_Frequency_scale_center+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( #Adj_Word_Frequency_scale_center+
                    Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 



fm13 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( 1  |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 
```

```{r}
#| label: fixed-Count
#| eval: false
#| include: false

fm13 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                 ( 1 |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 


fm15 <- glmer(IA_FIXATION_COUNT ~ 
                MWS_Length_CENTER+
      #          MWS_Repetition_Across_Sessions_CENTER+
  #              Adj_Word_Repetition_Across_Sessions_CENTER+
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum+
                Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                MWS_Frequency_scale_center+
                GROUP_sum:Adj_Word_Frequency_scale_center+
   #             GROUP_sum:Noun_Word_Frequency_scale_center+
                GROUP_sum:MWS_Frequency_scale_center+
                Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#                GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                ( 1 |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 

anova(fm13, fm15)
summary(fm15)
```

# Final model for fixation counts

```{r}
#| label: fm_final_COUNT


fm_final_count<- glmer(IA_FIXATION_COUNT ~ 
                   MWS_Length_CENTER+
                   Noun_Word_Repetition_Across_Sessions_CENTER+
                   GROUP_sum+
                   Adj_Word_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center+
                   GROUP_sum:MWS_Frequency_scale_center+
                   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   ( 1 |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson) 

summary(fm_final_count)
```

# Here, to plot Noun_Word_Frequency:MWS_Frequency

```{r}
#| label: plot <Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center>-Fixation_count


effectXY_count<-as.data.frame(effect("Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_count))
effectXY_count$pred_ms <- effectXY_count$fit
effectXY_count$se_ms <-  effectXY_count$se

ggplot(effectXY_count, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Noun_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Noun_Word_Frequency_scale_center), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))


ggplot(effectXY_count, aes(y = pred_ms, x= Noun_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

# Here, to plot GROUP:Adj_Word_Frequency:MWS_Frequency

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center>-fixation-count

effectXY_count<-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_count))
effectXY_count$pred_ms <- effectXY_count$fit 
effectXY_count$se_ms <- effectXY_count$se

ggplot(effectXY_count, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )

ggplot(effectXY_count, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center))+
  geom_smooth(aes( group= MWS_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )
```

# Nouns

```{r}
#| label: read data for noun regions

#|label: source pre-processing codes
GECOs <- read.delim('Data_Nouns.txt',header = TRUE, sep = "\t", encoding = "UTF-8", quote = "", na.strings=".")

source("pre-processing_v2.R")
library(lme4)
library(lmerTest)
library(effects)

```

## Total Reading Times

```{r}
#| label: Random-total-reading-time-nouns
#| eval: false
#| include: false

# Full model
fm1 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
               #   MWS_Frequency_scale_center + 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )
summary(fm8)



#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_DWELL_TIME_100_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_DWELL_TIME_100_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm10, refit=FALSE)
summary(fm10)




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_DWELL_TIME_100_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                #   Noun_Word_Frequency_scale_center+
                #   MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm11, refit=FALSE)
anova(fm10, fm11, refit=FALSE)




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_DWELL_TIME_100_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm12, refit=FALSE)
anova(fm10, fm12, refit=FALSE)
anova(fm11, fm12, refit=FALSE)




fm13 <- lmer(IA_DWELL_TIME_100_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm13, refit=FALSE)
anova(fm10, fm13, refit=FALSE)
anova(fm11, fm13, refit=FALSE)
anova(fm12, fm13, refit=FALSE)



#====================================================================================================#
#                                          fm12 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed-total-reading-time-nouns
#| eval: false
#| include: false

#fm12 is same with fm14 except "REML = FALSE" in fm14
fm14 <-  lmer(IA_DWELL_TIME_100_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, 
              REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm14)


fm15 <- lmer(IA_DWELL_TIME_100_LOG ~ 
               MWS_Length_CENTER+
#               MWS_Repetition_Across_Sessions_CENTER+
               Adj_Word_Repetition_Across_Sessions_CENTER+
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, 
             REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm14, fm15, refit=TRUE)
summary(fm15)
```

# Report final model for Total Reading Time

```{r}
#| label: fm_final-total-reading-time-nouns

fm_final_noun_total_time <- lmer(IA_DWELL_TIME_100_LOG ~ 
                   MWS_Length_CENTER+
                   Adj_Word_Repetition_Across_Sessions_CENTER+
                   Noun_Word_Repetition_Across_Sessions_CENTER+
                   GROUP_sum+
                   Adj_Word_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center+
                   GROUP_sum:Noun_Word_Frequency_scale_center+
                   GROUP_sum:MWS_Frequency_scale_center+
                   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                   (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, 
                 REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm_final_noun_total_time)
vif(fm_final_noun_total_time)
```

### Plot Group x Adj_Word_Frequency x MWS_Frequency

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center>-noun_total_time


effectXY_noun_total_time <-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_total_time))
effectXY_noun_total_time$pred_ms <- effectXY_noun_total_time$fit 
effectXY_noun_total_time$se_ms <- effectXY_noun_total_time$se

ggplot(effectXY_noun_total_time, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",linewidth=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~ GROUP_sum )


ggplot(effectXY_noun_total_time, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center), method="lm",linewidth=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~ GROUP_sum )
```

### Plot Noun_Word_Frequency x MWS_Frequency

```{r}
effectXY_noun_total_time<-as.data.frame(effect("Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_total_time))

effectXY_noun_total_time$pred_ms <- effectXY_noun_total_time$fit
effectXY_noun_total_time$se_ms <-  effectXY_noun_total_time$se

ggplot(effectXY_noun_total_time, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Noun_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Noun_Word_Frequency_scale_center), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))

ggplot(effectXY_noun_total_time, aes(y = pred_ms, x= Noun_Word_Frequency_scale_center, color = MWS_Frequency_scale_center))+
  geom_smooth(aes( group= MWS_Frequency_scale_center), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))

```

## First Fixation Duration

```{r}
#| label: Random-noun FFD
#| eval: false
#| include: false

# Full model
fm1 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
              #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
               #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
              #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
               #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                MWS_Frequency_scale_center #+ 
             #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
             #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
             |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
                 #   MWS_Frequency_scale_center + 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center #+ 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                  #   Noun_Word_Frequency_scale_center+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm11)




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                   Noun_Word_Frequency_scale_center#+
                   #   MWS_Frequency_scale_center + 
                   #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                   #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                   |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm11, fm12, refit=FALSE)
summary(fm12)



fm13 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm11, fm13, refit=FALSE)
anova(fm12, fm13, refit=FALSE)

summary(fm13)


#====================================================================================================#
#                                          fm13 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed-noun FFD
#| eval: false
#| include: false

#fm13 is same with fm14 except "REML = FALSE" in fm14
fm14 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm14)

fm15 <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
             MWS_Length_CENTER+
          #   MWS_Repetition_Across_Sessions_CENTER+
        #     Adj_Word_Repetition_Across_Sessions_CENTER+
             Noun_Word_Repetition_Across_Sessions_CENTER+
             GROUP_sum+
             Adj_Word_Frequency_scale_center+
             Noun_Word_Frequency_scale_center+
             MWS_Frequency_scale_center+
     #        GROUP_sum:Adj_Word_Frequency_scale_center+
             GROUP_sum:Noun_Word_Frequency_scale_center+
             GROUP_sum:MWS_Frequency_scale_center+
   #          Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
             Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#             GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
 #            GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


anova(fm14, fm15, refit=TRUE)

```

### Find the best fitting model for noun FFD

```{r}
#| label: fm_final-noun FFD
fm_final_noun_FFD  <- lmer(IA_FIRST_FIXATION_DURATION_LOG ~ 
             MWS_Length_CENTER+
             Noun_Word_Repetition_Across_Sessions_CENTER+
             GROUP_sum+
             Adj_Word_Frequency_scale_center+
             Noun_Word_Frequency_scale_center+
             MWS_Frequency_scale_center+
             GROUP_sum:Noun_Word_Frequency_scale_center+
             GROUP_sum:MWS_Frequency_scale_center+
             Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm_final_noun_FFD)
```

### Plot Group: Adj_Word_Frequency

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center>-noun_FFD


effectXY_noun_FFD<-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center", fm_final_noun_FFD))
effectXY_noun_FFD$pred_ms <- effectXY_noun_FFD$fit 
effectXY_noun_FFD$se_ms <- effectXY_noun_FFD$se

ggplot(effectXY_noun_FFD, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = GROUP_sum ))+
  geom_smooth(aes( group= GROUP_sum  ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

## First Run Dwell Time

```{r}
#| label: Random_noun_FRD
#| eval: false
#| include: false

# Full model
fm1 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
               #   MWS_Frequency_scale_center + 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                #   Noun_Word_Frequency_scale_center+
                #   MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm11)





#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                   |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm11, fm12, refit=FALSE)
summary(fm12)



fm13 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm11, fm13, refit=FALSE)
anova(fm12, fm13, refit=FALSE)


summary(fm13)

#====================================================================================================#
#                                          fm12 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed_noun_FRD
#| eval: false
#| include: false

#fm12 is same with fm14 except "REML = FALSE" in fm14
fm14 <-  lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all,
              REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary (fm14)


fm15 <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
 #              MWS_Repetition_Across_Sessions_CENTER+
#               Adj_Word_Repetition_Across_Sessions_CENTER+
  #             Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all,
             REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm14, fm15, refit=TRUE)
```

```{r}
#| label: fm_final_noun_FRD

fm_final_noun_FRD <- lmer(IA_FIRST_RUN_DWELL_TIME_LOG ~ 
               MWS_Length_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all,
             REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm_final_noun_FRD)
```

# Report GROUP :Adj_Word_Frequency: MWS_Frequency

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center>

effectXY_noun_FRD<-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_FRD))
effectXY_noun_FRD$pred_ms <- effectXY_noun_FRD$fit 
effectXY_noun_FRD$se_ms <- effectXY_noun_FRD$se

ggplot(effectXY_noun_FRD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm", linewidth=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~ GROUP_sum)


ggplot(effectXY_noun_FRD, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group=  MWS_Frequency_scale_center), method="lm", linewidth=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~ GROUP_sum)
```

```{r}
#| label: plot <Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center>-noun_FRD

effectXY_noun_FRD<-as.data.frame(effect("Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_FRD))
effectXY_noun_FRD$pred_ms <- effectXY_noun_FRD$fit 
effectXY_noun_FRD$se_ms <- effectXY_noun_FRD$se

ggplot(effectXY_noun_FRD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Noun_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Noun_Word_Frequency_scale_center ), method="lm", linewidth=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))


ggplot(effectXY_noun_FRD, aes(y = pred_ms, x= Noun_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group=  MWS_Frequency_scale_center), method="lm",linewidth=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

## Regression Path Duration

```{r}
#| label: Random_noun_RPD
#| eval: false
#| include: false

# Full model
fm1 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#

fm7 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
               #   MWS_Frequency_scale_center + 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm8)


#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm10, refit=FALSE)



#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                #   Noun_Word_Frequency_scale_center+
                #   MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm11, refit=FALSE)
anova(fm10, fm11, refit=FALSE)


#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm12, refit=FALSE)
anova(fm10, fm12, refit=FALSE)
summary(fm12)



fm13 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm13, refit=FALSE)
anova(fm10, fm13, refit=FALSE)
anova(fm12, fm13, refit=FALSE)

#====================================================================================================#
#                                          fm12 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed_noun_RPD
#| eval: false
#| include: false

#fm12 is same with fm14 except "REML = FALSE" in fm14
fm14 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, 
             REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm14)

fm15 <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
#               MWS_Repetition_Across_Sessions_CENTER+
               Adj_Word_Repetition_Across_Sessions_CENTER+
 #              Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, 
             REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )
#            


anova(fm14, fm15, refit=TRUE)


```

```{r}
#| label: fm_final_noun_RPD

fm_final_noun_RPD <- lmer(IA_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
          
               Adj_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, 
             REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


summary(fm_final_noun_RPD)

```

### Report Noun_Word_Frequency :MWS_Frequency

```{r}
#| label: plot <Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center>-noun_RPD

effectXY_noun_RPD<-as.data.frame(effect("Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_RPD))
effectXY_noun_RPD$pred_ms <- effectXY_noun_RPD$fit 
effectXY_noun_RPD$se_ms <- effectXY_noun_RPD$se

ggplot(effectXY_noun_RPD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Noun_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Noun_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))

ggplot(effectXY_noun_RPD, aes(y = pred_ms, x= Noun_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

### Report GROUP : Adj_Word_Frequence : MWS_Frequency

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center>-noun_RPD

effectXY_noun_RPD<-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_RPD))
effectXY_noun_RPD$pred_ms <- effectXY_noun_RPD$fit 
effectXY_noun_RPD$se_ms <- effectXY_noun_RPD$se

ggplot(effectXY_noun_RPD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )


ggplot(effectXY_noun_RPD, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center))+
  geom_smooth(aes( group= MWS_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )
```

## Selective Regression Path Duration

```{r}
#| label: Random-noun-SRPD
#| eval: false
#| include: false

# Full model
fm1 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )



#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 #   MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #  Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center + 
                 Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )




#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (#Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center#+
               #   MWS_Frequency_scale_center + 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm8)
 



#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
              MWS_Length_CENTER+
              MWS_Repetition_Across_Sessions_CENTER +
              Adj_Word_Repetition_Across_Sessions_CENTER +
              Noun_Word_Repetition_Across_Sessions_CENTER+
              GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
              
              (Adj_Word_Frequency_scale_center+
                 #   Noun_Word_Frequency_scale_center+
                 MWS_Frequency_scale_center #+ 
               #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
               #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
               |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )





#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#  Adj_Word_Frequency_scale_center+
                 Noun_Word_Frequency_scale_center+
                   MWS_Frequency_scale_center #+ 
                 #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                 #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm10, refit=FALSE)
summary(fm10)

            




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center #+
                #   Noun_Word_Frequency_scale_center+
                #   MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm11, refit=FALSE)
anova(fm10, fm11, refit=FALSE)
summary(fm11)





#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <-  lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (#   Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm12, refit=FALSE)
anova(fm10, fm12, refit=FALSE)
anova(fm11, fm12, refit=FALSE)
summary(fm12)




fm13 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (1|PP_ID) + (1|IA_LABEL) , data = Data_all, REML = TRUE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm8, fm13, refit=FALSE)
anova(fm10, fm13, refit=FALSE)
anova(fm11, fm13, refit=FALSE)

#====================================================================================================#
#                                          fm12 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed-noun-SRPD
#| eval: false
#| include: false

#fm12 is same with fm14 except "REML = FALSE" in fm14
fm14 <-  lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, 
              REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )


summary(fm14)

fm15 <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
#               MWS_Repetition_Across_Sessions_CENTER+
               Adj_Word_Repetition_Across_Sessions_CENTER+
  #             Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, 
             REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

anova(fm14, fm15, refit=TRUE)

```

```{r}
#| label: fm_final-noun-SRPD

fm_final_noun_SRPD <- lmer(IA_SELECTIVE_REGRESSION_PATH_DURATION_LOG ~ 
               MWS_Length_CENTER+
               Adj_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               (Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all, 
             REML = FALSE, control = lmerControl(optimizer = 'bobyqa', optCtrl = list(maxfun =200000) ) )

summary(fm_final_noun_SRPD)
```

### Plot GROUP : Adj_Word_Frequency : MWS_Frequency

```{r}
#| label: plot <GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center-noun_SRPD

effectXY_noun_SRPD<-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_SRPD))
effectXY_noun_SRPD$pred_ms <- effectXY_noun_SRPD$fit 
effectXY_noun_SRPD$se_ms <- effectXY_noun_SRPD$se

ggplot(effectXY_noun_SRPD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )

ggplot(effectXY_noun_SRPD, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum)
```

### Plot Noun_Word_Frequency : MWS_Frequency

```{r}
#| label: plot <Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center>-noun_SRPD

effectXY_noun_SRPD<-as.data.frame(effect("Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_SRPD))
effectXY_noun_SRPD$pred_ms <- effectXY_noun_SRPD$fit 
effectXY_noun_SRPD$se_ms <- effectXY_noun_SRPD$se

ggplot(effectXY_noun_SRPD, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Noun_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Noun_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))

ggplot(effectXY_noun_SRPD, aes(y = pred_ms, x= Noun_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))
```

## Skip

```{r}
#| label: Random-noun_skip 
#| eval: false
#| include: false

# Full model
fm1 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )


#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
                #  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm2)




#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm3)
anova(fm2, fm3)



#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
              #    MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm4)
anova(fm3, fm4)



#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                #  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm5)



#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#

fm6 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm6)
anova(fm3, fm6)
anova(fm4, fm6)



#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                MWS_Frequency_scale_center #+ 
             #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
             #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                 |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm7)



#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                #  MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm8)



#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  #Noun_Word_Frequency_scale_center+
                    MWS_Frequency_scale_center #+ 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm9)
anova(fm3, fm9)
anova(fm4, fm9)
anova(fm6, fm9)


#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (# Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center #+ 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm10)
anova(fm3, fm10)
anova(fm4, fm10)
anova(fm6, fm10)
anova(fm9, fm10)

#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( Adj_Word_Frequency_scale_center#+
                  # Noun_Word_Frequency_scale_center+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all,
              family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm11)



#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( #Adj_Word_Frequency_scale_center+
                    Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all,
              family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

anova(fm1, fm12)




fm13 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( 1|PP_ID) + (1|IA_LABEL) , data = Data_all,
              family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )
anova(fm1, fm13)


#====================================================================================================#
#                                          fm8 is the best                                          #
#====================================================================================================#
```

```{r}
#| label: fixed-noun_skip 
#| eval: false
#| include: false

fm8 <- glmer(IA_SKIP ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all,
             family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F))

summary(fm8)


fm15 <-  glmer(IA_SKIP ~ 
               MWS_Length_CENTER+
       #        MWS_Repetition_Across_Sessions_CENTER+
         #      Adj_Word_Repetition_Across_Sessions_CENTER+
          #     Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
    #           GROUP_sum:Adj_Word_Frequency_scale_center+
     #          GROUP_sum:Noun_Word_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
             #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
  #             GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                (Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all,
              family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )
  
anova(fm8, fm15)

```

```{r}
#| label: fm_final-noun_skip 

fm_final_noun_skip <-  glmer(IA_SKIP ~ 
               MWS_Length_CENTER+
               GROUP_sum+
               Adj_Word_Frequency_scale_center+
               Noun_Word_Frequency_scale_center+
               MWS_Frequency_scale_center+
               GROUP_sum:MWS_Frequency_scale_center+
               Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                (Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center|PP_ID) + (1|IA_LABEL) , data = Data_all,
              family=binomial,  control = glmerControl(optimizer = "nloptwrap", calc.derivs = F)  )

summary(fm_final_noun_skip)


```

### Plot Adj_Word_Frequency : MWS_Frequency

```{r}
#| label: plot <Adj_Word_Frequency:MWS_Frequency_scale_center>-noun_skip 

effectXY_noun_skip <-as.data.frame(effect("Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_skip))
effectXY_noun_skip$pred_ms <- effectXY_noun_skip$fit
effectXY_noun_skip$se_ms <-  effectXY_noun_skip$se

ggplot(effectXY_noun_skip, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center))+
  geom_smooth(aes( group= MWS_Frequency_scale_center), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))

```

## Fixation Count

```{r}
#| label: Random-noun-count
#| eval: false
#| include: false

# Full model
library(optimx)
fm1 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
             control=glmerControl(optimizer = "optimx", calc.derivs = FALSE, 
                                  optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 





#------------------------------------------------------------------------------#
#--- remove < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center > ---#
#------------------------------------------------------------------------------#
fm2 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center #+ 
                #  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
             control=glmerControl(optimizer = "optimx", calc.derivs = FALSE, 
                                  optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 






#-------------------------------------------------------------------------------#
#---  remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >  ---#
#-------------------------------------------------------------------------------#
fm3 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                #  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson,
             control=glmerControl(optimizer = "optimx", calc.derivs = FALSE,
                                  optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 





#-------------------------------------------------------------------------------#
#---                  remove < MWS_Frequency_scale_center >                  ---#
#-------------------------------------------------------------------------------#
fm4 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
              #    MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
              |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
             control=glmerControl(optimizer = "optimx", calc.derivs = FALSE,
                                  optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 




#-------------------------------------------------------------------------------#
#---               remove < Noun_Word_Frequency_scale_center >              ---#
#-------------------------------------------------------------------------------#
fm5 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                #  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson,
             control=glmerControl(optimizer = "optimx", calc.derivs = FALSE, 
                                  optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 





#-------------------------------------------------------------------------------#
#---               remove < Adj_Word_Frequency_scale_center >                ---#
#-------------------------------------------------------------------------------#
fm6 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (#Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center + 
                  Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
             control=glmerControl(optimizer = "optimx", calc.derivs = FALSE,
                                  optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 





#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm7 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                MWS_Frequency_scale_center #+ 
             #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
             #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
             |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
             control=glmerControl(optimizer = "optimx", calc.derivs = FALSE, 
                                  optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 




#-------------------------------------------------------------------------------#
#    remove < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm8 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center#+
                #  MWS_Frequency_scale_center + 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson,
             control=glmerControl(optimizer = "optimx", calc.derivs = FALSE, 
                                  optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm9 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (Adj_Word_Frequency_scale_center+
                  #Noun_Word_Frequency_scale_center+
                    MWS_Frequency_scale_center #+ 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson,
             control=glmerControl(optimizer = "optimx", calc.derivs = FALSE, 
                                  optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 




#-------------------------------------------------------------------------------#
#    remove < Adj_Word_Frequency_scale_center >                                 #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm10 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
               MWS_Repetition_Across_Sessions_CENTER +
               Adj_Word_Repetition_Across_Sessions_CENTER +
               Noun_Word_Repetition_Across_Sessions_CENTER+
               GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
               
               (# Adj_Word_Frequency_scale_center+
                  Noun_Word_Frequency_scale_center+
                  MWS_Frequency_scale_center #+ 
                #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson,
              control=glmerControl(optimizer = "optimx", calc.derivs = FALSE, 
                                   optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 




#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm11 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( Adj_Word_Frequency_scale_center#+
                  # Noun_Word_Frequency_scale_center+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson,
              control=glmerControl(optimizer = "optimx", calc.derivs = FALSE, 
                                   optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 



#-------------------------------------------------------------------------------#
#    remove < Noun_Word_Frequency_scale_center >                                #
#           < MWS_Frequency_scale_center >                                      #
#           < Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center >      #
#           < Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center >     #
#-------------------------------------------------------------------------------#
fm12 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( #Adj_Word_Frequency_scale_center+
                    Noun_Word_Frequency_scale_center#+
                  #   MWS_Frequency_scale_center + 
                  #   Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center + 
                  #   Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center
                  |PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
              control=glmerControl(optimizer = "optimx", calc.derivs = FALSE, 
                                   optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 



fm13 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( 1|PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
              control=glmerControl(optimizer = "optimx", calc.derivs = FALSE,  
                                   optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 
```

```{r}
#| label: fixed-noun-count
#| eval: false
#| include: false

fm14 <- glmer(IA_FIXATION_COUNT ~ MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER +
                Adj_Word_Repetition_Across_Sessions_CENTER +
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum*(Adj_Word_Frequency_scale_center+Noun_Word_Frequency_scale_center)*MWS_Frequency_scale_center+ 
                
                ( 1|PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
              control=glmerControl(optimizer = "optimx", calc.derivs = FALSE,  
                                   optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 

summary(fm14)

fm15 <-  glmer(IA_FIXATION_COUNT ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER+
       #         Adj_Word_Repetition_Across_Sessions_CENTER+
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum+
                Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                MWS_Frequency_scale_center+
    #            GROUP_sum:Adj_Word_Frequency_scale_center+
  #              GROUP_sum:Noun_Word_Frequency_scale_center+
                GROUP_sum:MWS_Frequency_scale_center+
   #             Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
#                GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center+
 #               GROUP_sum:Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                ( 1|PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
              control=glmerControl(optimizer = "optimx", calc.derivs = FALSE,  
                                   optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 
  
  
anova(fm14, fm15)

```

```{r}
#| label: fm_final-noun-count

fm_final_noun_count <-  glmer(IA_FIXATION_COUNT ~ 
                MWS_Length_CENTER+
                MWS_Repetition_Across_Sessions_CENTER+
                Noun_Word_Repetition_Across_Sessions_CENTER+
                GROUP_sum+
                Adj_Word_Frequency_scale_center+
                Noun_Word_Frequency_scale_center+
                MWS_Frequency_scale_center+
                GROUP_sum:MWS_Frequency_scale_center+
                Noun_Word_Frequency_scale_center:MWS_Frequency_scale_center+
                ( 1|PP_ID) + (1|IA_LABEL) , data = Data_all, family= poisson, 
              control=glmerControl(optimizer = "optimx", calc.derivs = FALSE,  
                                   optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE))) 


summary(fm_final_noun_count)

```

```{r}
#| label: plot <GROUP_sum:MWS_Frequency_scale_center>-noun-count


effectXY_noun_count<-as.data.frame(effect("GROUP_sum:Adj_Word_Frequency_scale_center:MWS_Frequency_scale_center", fm_final_noun_count))
effectXY_noun_count$pred_ms <- effectXY_noun_count$fit
effectXY_noun_count$se_ms <- effectXY_noun_count$se


ggplot(effectXY_noun_count, aes(y = pred_ms, x= MWS_Frequency_scale_center, color = Adj_Word_Frequency_scale_center ))+
  geom_smooth(aes( group= Adj_Word_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum )

ggplot(effectXY_noun_count, aes(y = pred_ms, x= Adj_Word_Frequency_scale_center, color = MWS_Frequency_scale_center ))+
  geom_smooth(aes( group= MWS_Frequency_scale_center ), method="lm",size=0.6)+
  geom_point(aes())+
  geom_errorbar(aes ( ymin=pred_ms-se_ms, ymax=pred_ms+se_ms,  width=0.3))+
  facet_wrap(~GROUP_sum)


```
